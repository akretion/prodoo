"use strict";angular.module("prodapps",["ngAnimate","ngSanitize","ui.router","mgcrea.ngStrap","odoo","notification","ionic"]).config(["$stateProvider","$urlRouterProvider","jsonRpcProvider","prodooConfigProvider",function(e,n,t,r){e.state("main",{templateUrl:"app/main/main.html",resolve:{apps:"apps"}}).state("main.home",{url:"/",templateUrl:"app/main/home.html",controller:"MainCtrl",resolve:{apps:"apps"}}).state("login",{url:"/login",templateUrl:"app/login/login.html",controller:"LoginCtrl",data:{}}).state("main.assembly",{url:"/assembly/{workcenter:int}",views:{"":{templateUrl:"app/assembly/assembly.html",controller:"AssemblyCtrl"},"orderList@main.assembly":{controller:"OrderListCtrl",templateUrl:"app/assembly/orderList.html"}}}).state("main.configuration",{url:"/configuration",templateUrl:"app/configuration/configuration.html",controller:"ConfigurationCtrl",resolve:{apps:"apps"}}).state("main.tdcp",{url:"/tdcp/{workcenter:int}",templateUrl:"app/tdcp/tdcp.html",controller:"TdcpCtrl",resolve:{apps:"apps"}}),n.otherwise("/"),t.odooRpc.odoo_server=r.config.odooServer}]).run(["$rootScope","$state","jsonRpc","prodooConfig","$notification",function(e,n,t,r,i){e.$on("$stateChangeStart",function(e,r,a){"login"!==r.name&&(t.isLoggedIn()||(console.log("not logged in"),e.preventDefault(),n.get("login").data.params=a,n.get("login").data.state=r.name,n.go("login")),angular.element("body").on("shown.bs.modal",function(e){angular.element(e.currentTarget).find("[autofocus]").focus()}),t.errorInterceptors.push(function(e){console.log("Error with webservice: ",e),"session_expired"==e.title?n.go("login"):i("Webservice error: "+e.title)}))})}]),angular.module("prodapps").provider("prodooSync",[function(){var e={};return e.liste={},this.$get=["jsonRpc","prodooConfig",function(n,t){return e.syncData=function(r,i){var a={model:"mrp.production.workcenter.line",func_key:"prodoo",base_domain:[["workcenter_id","=",r.workcenter]],filter_domain:[["production_state","not in",["draft","cancel"]],["full_done","=",!1]],limit:t.fetchLimit,interval:t.refreshInterval,current_list:r.current_list};return e.liste=n.syncImportObject(a),e.liste.watch(function(){i.data=[];var n,t,r=null;for(t in e.liste.data)n=e.liste.data[t],i.data.push(n),"done"!=n.state&&(!r||r.sequence>n.sequence)&&(r=n);i.current.item&&e.liste.data[i.current.item.id]||(i.current.item=r)}),e.liste.stopCallback},e}],this}]),angular.module("prodapps").provider("prodooPrint",[function(){return this.$get=["$http","prodooConfig","Beep",function(e,n,t){return function(r,i){r._v.labels.forEach(function(a){var o={args:[a.printer,a.data],kwargs:{options:{copies:i?i:r.quantities}}};t.play(),e.post(n.pyWebDriver+"/cups/printData",o),console.log("print !!!!",r)})}}],this}]),angular.module("prodapps").provider("prodooMachine",[function(){return this.$get=["$http","prodooConfig","Beep",function(e,n,t){return function(r){var i=r.machine;t.play(),"serial"==i.type?e.post(n.pyWebDriver+"/hw_proxy/serial_write",i):"opc"==i.type?e.post(n.pyWebDriver+"/hw_proxy/opcua_write",i):"url"==i.type?e.post(i.url,i.data):"plc"==i.type&&e.post(n.pyWebDriver+"/hw_proxy/plc_write",i)}}],this}]),angular.module("prodapps").provider("prodooConfig",[function(){return this.config={odooServer:"/odoo",db:"sd_production",refreshInterval:5e3,fetchLimit:50,pyWebDriver:"https://localhost",displayLimit:50},this.$get=[function(){var e=JSON.parse(window.localStorage.getItem("config"));return e?(null!=e.odooServer&&""!=e.odooServer&&void 0!=e.odooServer&&(console.log("override odooServer"),this.config.odooServer=e.odooServer),null!=e.pyWebDriver&&""!=e.pyWebDriver&&void 0!=e.pyWebDriver&&(console.log("override pyWebDriver"),this.config.pyWebDriver=e.pyWebDriver),this.config):this.config}],this}]),angular.module("prodapps").controller("NavbarCtrl",["$scope","$state","$stateParams","apps",function(e,n,t,r){function i(e){return e&&a.filter(function(n){return n.id===e}).pop().name}var a;e.workcenter_id=0,r.then(function(n){a=n.workcenters,e.title=i(t.workcenter)}),e.$on("$stateChangeSuccess",function(){e.workcenter_id=void 0==t.workcenter||null==t.workcenter?0:t.workcenter,e.title=e.workcenter_id>0?i(t.workcenter):""})}]),angular.module("prodapps").controller("TdcpCtrl",["$scope","$stateParams","$state","jsonRpc","$notification",function(e,n,t,r,i){function a(n){if(i("searchin for TDCP"),0==e.workcenter)var t="mrp.production",a=[["name","=",n]],o=["table_tech_description"];else var t="mrp.production.workcenter.line",a=[["production_number","=",n],["workcenter_id","=",e.workcenter]],o=["name","short_description","description"];r.searchRead(t,a,o).then(function(n){console.log(n),e.tdcp.search=n.records},function(){i("an error has occured")})}e.tdcp={},e.workcenter=t.params.workcenter,console.log(t.params.workcenter),e.$watch("tdcp.lot_number",function(e){e&&a(e)}),e.goBack=function(){e.workcenter>0?t.go("main.assembly",{workcenter:e.workcenter}):t.go("main.home")},e.clear=function(){delete e.tdcp.lot_number},e.eraseSearch=function(){delete e.tdcp.lot_number}}]),angular.module("prodapps").controller("LoginCtrl",["$scope","$state","jsonRpc","prodooConfig","$stateParams",function(e,n,t,r){angular.element("#loginPassword").trigger("focus"),e.login=function(i){var a=" ";if(-1!=i.indexOf(a))var o=i.split(a)[0],s=i.split(a)[1];else var o="based_on_token",s=i;e.error="Loading...",t.login(r.db,o,s).then(function(){var t=n.current.data;e.error="Ok",t.state?n.go(t.state,t.params):n.go("main.home")},function(){e.error="Authentication failed for "+o})},e.logout=function(){console.log("logout"),t.logout(!0)},e.logout()}]),angular.module("prodapps").controller("MainCtrl",["$scope","$state","apps",function(e,n,t){e.$state=n,e.workcenters=t.workcenters,e.groups=t.groups,angular.element("#barcode").trigger("focus")}]),angular.module("prodapps").factory("apps",["jsonRpc",function(e){return e.call("mrp.workcenter","prodoo_get_workcenter",[]).then(function(e){var n=e,t={};return n.forEach(function(e){t[e.group]||(t[e.group]=[]),t[e.group].push(e)}),{workcenters:n,groups:t}})}]),angular.module("prodapps").controller("OrderListCtrl",["$scope","limitToFilter","filterFilter","orderByFilter","prodooConfig","$ionicScrollDelegate","$timeout",function(e,n,t,r,i,a,o){function s(){e.filteredList={notDone:c(e.sync.data,{state:"!done"})},e.sync.current.filter.lot_number&&l()}function l(){var n=angular.copy(e.sync.current.filter),t=n.lot_number;return delete n.lot_number,e.sync.data.some(function(e){return e.lot_number!=t?!1:(n.sale_name=e.sale_name,!0)}),n.sale_name?(e.filteredList.search=c(e.sync.data,n),void(e.sync.current.item.sale_name!=n.sale_name&&e.filteredList.search.some(function(n){return n.lot_number!=t?!1:(e.clickTask(n),!0)}))):e.filteredList.search=[]}function c(e,a){return n(r(t(e,a),"sequence"),i.displayLimit)}function d(n){var t,r,i=e.sync.current.filter;n&&(t=i.sale_name||i.lot_number?"search":"notDone",r=!1,e.filteredList[t].some(function(e){return e.sequence<=n.sequence?!1:(r=e,!0)}),r&&e.clickTask(r))}e.filteredList={notDone:[],Done:[]},e.$watch("sync.data",function(e,n){e!=n&&s()}),e.$watch("sync.current.filter.lot_number",function(e){e&&l()}),e.$on("syncAfterDone",function(e,n){s(),d(n)}),e.clickTask=function(n){n&&(e.sync.current.item=n,e.sync.current.filter.sale_name||o(function(){var e=angular.element("#item"+n.id)[0];a.$getByHandle("leftScroll").scrollTo(0,e.offsetTop,!0)},50))},e.eraseSearch=function(){delete e.sync.current.filter.sale_name,delete e.sync.current.filter.lot_number,a.$getByHandle("leftScroll").scrollTop(),a.$getByHandle("rightScroll").scrollTop()}}]),angular.module("prodapps").directive("enterFocus",[function(){return{restrict:"A",scope:{scans:"=enterFocus"},link:function(e,n){e.buildQuery=function(n){var t,r,i,a,o;if(t=n.split("-"),r=t[0],i=parseInt(t[1]),a=parseInt(t[2]),"scan"===r)o=void 0!==e.scans[i][a+1]?[r,i,a+1]:["casier",i,0];else{if(void 0===e.scans[i+1])return null;o=["scan",i+1,0]}return"#"+o.join("-")},n.bind("keydown keypress",function(n){if(13===n.which){n.preventDefault();var t=n.currentTarget.id,r=e.buildQuery(t);r?angular.element(r).focus():n.currentTarget.blur()}})}}}]),angular.module("prodapps").directive("ensureValue",[function(){return{require:"ngModel",link:function(e,n,t,r){function i(e,n){var t=e===n;return r.$setValidity("ensureValue",t),t}t.$observe("ensureValue",function(e){i(r.$modelValue,e)}),r.$validators.ensureValue=function(e){return i(e,t.ensureValue)}}}}]),angular.module("prodapps").controller("AssemblyCtrl",["$scope","$state","jsonRpc","prodooSync","$notification","prodooPrint","prodooMachine","$timeout",function(e,n,t,r,i,a,o,s){function l(e){return e._v.labels||t.call("mrp.production.workcenter.line","get_pdf",[e.id]).then(function(n){e._v.labels=n})}function c(e){var n=[],t=0;for(t=0;e>t;t++)n.push(null);return n}function d(e){var n=[];if(null!=e){if(e.length>0){for(var t=0;t<e.length;t++)n.push(e[t].id);return n}return[]}return[]}e.sync={data:null,current:{filter:{state:"!done"}}},e.workcenter=n.params.workcenter;var u=r.syncData({workcenter:e.workcenter,current_list:function(){return d(e.sync.data)}},e.sync);e.$on("$destroy",u),e.fields=[],e.sameLotNumber=[],e.scrap={add:!1},e.$watch("sync.current.item",function(n){n&&(n._v=n._v||{},n._v.started=!1,n._v.resign_reasons=!1,l(n),e.fields=n.components,e.sameLotNumber=e.sync.data.filter(function(e){return e.lot_number===n.lot_number&&e.id!=n.id}),n._v.suggestedRacks=e.sameLotNumber.length?e.sameLotNumber[0].rack:[],0==n._v.suggestedRacks.length&&(n._v.suggestedRacks=c(n.number_of_lines).map(function(e,t){return n.components.map(function(e){return e.rack[t]})}).map(function(e){return e[0]!=e[1]?e.join(","):e[0]})),n._v.lines?n._v.racks=n._v.lines.some(function(e){return e.rack&&e.rack.length>0})?n._v.lines.map(function(e){return e.rack}):n._v.suggestedRacks:(n._v.racks=n.rack,n._v.racks.length||(n._v.racks=n._v.suggestedRacks)),n._v.scans||(n._v.scans=c(n.number_of_lines).map(function(){return c(n.components.length)})),n._v.locks||(n._v.locks=c(n.number_of_lines).map(function(){return!1})),n._v.lines=c(n.number_of_lines).map(function(e,t){var r={};return r.scans=n._v.scans[t],r.rack=n._v.racks[t],r.lock=n._v.locks[t],r}),n._v.raw_materials||(n._v.raw_materials={},n._v.raw_materials.expected=n.raw_materials_expected),n.scrap_managment&&e.searchScrap(n))}),e.checkLocks=function(){return e.sync.current.item&&e.sync.current.item._v?0!==e.sync.current.item._v.lines.filter(function(e){return 0==e.lock}).length:!1},e.book=function(e){e._v.lock=!0,t.call("mrp.production.workcenter.line","prodoo_book",[e.id]).then(function(){i("Done")},function(){i("an error has occured")}).then(function(){e._v.lock=!1})},e.focusOnLineRack=function(e){e.rack="",e.lock=!1},e.focusOnLineScan=function(e,n){e.scans[n]="",e.lock=!1},e.isLineValid=function(e,n){return e[n].$valid},e.printAfterScan=function(e,n,t){return e.enablePrintAfterScan?n[t].$valid:!0},e.$watch("line.rack",function(n){n&&(e.scrap.search=!1)}),e.do=function(n){i("Pending"),n._v.lock=!0,n.rack=n._v.lines.map(function(e){return e.rack}),t.call("mrp.production.workcenter.line","prodoo_action_done",[n.id,n.rack]).then(function(){n.state="done",i("Done"),e.$broadcast("syncAfterDone",n)},function(){i("an error has occured")}).then(function(){s(function(){n._v.lock=!1},1e3)})},e.$watch("scrap.add",function(n){n&&(e.scrap.search=!1)}),e.addScrap=function(n){i("Saving scrap"),t.call("mrp.production.workcenter.line","scrap_add",[n.id,e.scrap]).then(function(){i("Scrap saved"),e.scrap={add:!1}},function(){i("an error has occured")})},e.searchScrap=function(n){return e.scrap.add=!1,i("Searching scrap"),t.call("mrp.production.workcenter.line","scrap_search",[n.id,e.scrap]).then(function(n){e.scrap.search=!0,e.scrap.avaiable=n},function(){i("an error has occured")}),!0},e.useScrap=function(n,r){return i("Take scrap for use"),t.call("mrp.production.workcenter.line","scrap_use",[r.id,n]).then(function(){e.scrap.search=!1,e.scrap.add=!1,e.scrap.avaiable={}},function(){i("an error has occured")}),!0},e.searchScrapEnter=function(n){13===n.which&&e.searchScrap(e.sync.current.item)},e.eraseScrapSearch=function(){delete e.scrap.material,e.scrap.canSearch=!1,e.scrap.search=!1,delete e.scrap.avaiable,e.scrap.add=!1},e.print=function(e,n){i("Printing..."),a(e,n)},e.machine=function(e){o(e)},e.openInNewTab=function(e){var n=e.quality_form_url+e.quality_form_order_number_id+"="+e.lot_number;window.open(n,"_blank")},e.take=function(n){n._v.lock=!0,t.call("mrp.production.workcenter.line","book",[[n.id],e.workcenter]).then(function(t){console.log("voici le result",t),t?(n.workcenter_id=e.workcenter,i("Booked")):(n.workcenter_id=!1,i("Already booked"))}).then(function(){s(function(){n._v.lock=!1},1e3)})},e.start=function(e){e._v.started=!0,t.call("mrp.production.workcenter.line","prodoo_action_start",[e.id])},e.resign=function(e,n){t.call("mrp.production.workcenter.line","prodoo_action_resign",[e.id,n]),e._v.started=!1,e.resign_reason=n},e.rawMaterialScan=function(e){var n=e._v.raw_materials.input,t=e._v.raw_materials.expected,r=t.filter(function(e){return e.barcode==n});r.length?r[0].scanned=!0:console.error("Material not found"),e._v.raw_materials.input=""}}]),angular.module("prodapps").controller("ConfigurationCtrl",["$scope","$state",function(e){e.config=JSON.parse(window.localStorage.getItem("config"))||{},e.save=function(){window.localStorage.setItem("config",JSON.stringify(e.config))}}]),angular.module("prodapps").factory("Beep",[function(){var e=new Audio("data:video/ogg;base64,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");return{play:function(){e.play()}}}]),angular.module("prodapps").run(["$templateCache",function(e){e.put("app/configuration/configuration.html",'<div class="container-fluid"><h1>Prodoo local configuration</h1><form class="form-horizontal" ng-submit="save()"><div class="form-group"><label for="odooServer" class="col-sm-2 control-label">Odoo Server</label><div class="col-sm-10"><input type="email" class="form-control" ng-model="config.odooServer" id="odooServer" placeholder="Odoo Server"></div></div><div class="form-group"><label for="pyWebDriver" class="col-sm-2 control-label">Printer address</label><div class="col-sm-10"><input type="text" class="form-control" ng-model="config.pyWebDriver" id="pyWebDriver" placeholder="Printer address"></div></div><div class="form-group"><div class="col-sm-offset-2 col-sm-10"><button type="submit" class="btn btn-success">Save</button></div></div></form></div>'),e.put("app/assembly/assembly.html",'<div style="position: fixed; width: 100%; height: 100%;"><div class="container-fluid"><style>\n    .list-group.active {\n        display:none;\n    }\n    .draft {\n        color: #666;\n    }\n\n    tbody.ng-invalid-ensure-value.ng-dirty {\n      background-color:#f2dede;\n    }\n    .haute-ligne {\n        height: 3.5em;\n    }\n\n@-moz-keyframes spin { 0% { -moz-transform: rotate(0deg); }\n  100% { -moz-transform: rotate(359deg); } }\n@-webkit-keyframes spin { 0% { -webkit-transform: rotate(0deg); }\n  100% { -webkit-transform: rotate(359deg); } }\n@-o-keyframes spin { 0% { -o-transform: rotate(0deg); }\n  100% { -o-transform: rotate(359deg); } }\n@-ms-keyframes spin { 0% { -ms-transform: rotate(0deg); }\n  100% { -ms-transform: rotate(359deg); } }\n@keyframes spin { 0% { transform: rotate(0deg); }\n  100% { transform: rotate(359deg); } }\n\n</style><div class="row big-list"><div ng-if="!sync.data"><h1>Loading <span class="glyphicon glyphicon-refresh" style="animation-timing-function: steps(8, start); animation: 1s linear 0s normal none infinite running spin;"></span></h1></div><div ng-show="sync.data.length == 0"><h2>No data</h2></div></div><div class="row big-list" ng-show="sync.data.length"><div class="col-md-5 col-no-padding"><div ui-view="orderList"></div></div><div class="col-md-7" style="position:relative" ng-class="{true: \'draft\'}[sync.current.item.state==\'done\']"><div ng-show="sync.current.item.btnStartEnable"><div class="well" style="height:600px;" ng-click="start(sync.current.item)" ng-show="sync.current.item" ng-hide="sync.current.item._v.started"><h1>{{ sync.current.item.name }}</h1><h2>{{ sync.current.item.lot_number }}</h2><button class="btn btn-success haute-ligne" style="width:100%;" ng-hide="sync.current.item.resign_reason">Start</button><div ng-show="sync.current.item.resign_reason"><button class="btn btn-success haute-ligne" style="width:100%;">Continue</button><p>{{sync.current.item.resign_reason}}</p></div></div></div><ion-scroll class="prodoo-ion-scroll" delegate-handle="rightScroll" direction="y" ng-show="sync.current.item._v.started || !sync.current.item.btnStartEnable"><div class="well"><h3>{{ sync.current.item.name}}</h3><div ng-bind-html="sync.current.item.description"></div><h2 ng-show="fields.length">Shelves</h2><table class="table"><tr ng-repeat="field in fields"><th>{{ field.name }}</th><td>{{ field.rack }}</td></tr></table></div><div><div class="btn-group btn-group-justified"><div class="btn-group" ng-show="sync.current.item.workcenter_id != workcenter"><button ng-show="sync.current.item.workcenter_id" class="btn btn-success haute-ligne" ng-click="take(sync.current.item)" ng-disabled="sync.current.item._v.lock"><span class="glyphicon glyphicon-download-alt"></span> Book <span class="badge badge-default">+ {{ sameLotNumber.length }}</span></button> <button ng-hide="sync.current.item.workcenter_id" class="btn btn-danger haute-ligne" disabled="">Already taken by someone else</button></div></div></div><form name="raw_materials" ng-submit="rawMaterialScan(sync.current.item)" ng-show="sync.current.item._v.raw_materials.expected.length"><fieldset ng-disabled="sync.current.item.workcenter_id != workcenter"><table class="table table-condensed" style="word-break: break-all;"><tr><th>Material</th><th>Barcode</th></tr><tr ng-repeat="material in sync.current.item._v.raw_materials.expected track by $index" ng-class="{true: \'locked\'}[material.scanned]"><td>{{ material.name }}</td><td>{{ material.barcode }} <input type="checkbox" ng-model="material.scanned" required="" disabled=""> {{material.scanned }}</td></tr><tr><td>Scan here all the bardcodes</td><td><input name="raw_mat_input" ng-model="sync.current.item._v.raw_materials.input"></td></tr></table>{{ raw_materials.$invalid }}</fieldset></form><div class="panel panel-default" ng-show="sync.current.item.scrap_managment"><div class="panel-heading">Scrap actions</div><div class="panel-body"><div class="input-group"><div class="input-group-addon"><label for="searchScrapInput"><span class="glyphicon glyphicon-search"></span></label></div><input ng-model="scrap.material" class="form-control haute-ligne" id="searchScrapInput" ng-keypress="searchScrapEnter($event)" placeholder="search scrap" ng-focus="eraseScrapSearch()"><span class="input-group-btn"><button type="button" class="btn btn-primary haute-ligne" ng-click="searchScrap(sync.current.item)">Search</button> <button type="button" class="btn btn-success haute-ligne" ng-click="(scrap.add) ? (scrap.add=false):(scrap.add=true)" style="margin-left: 5px;">Add</button></span></div><form name="scrap_add" ng-submit="addScrap(sync.current.item)" ng-show="scrap.add"><p class="h4 mb-4">Add new scrap</p><fieldset><table class="table table-condensed" style="word-break: break-all;"><tr><th>Height (mm)</th><th>Width (mm)</th><th>Location</th><th ng-show="sync.current.item.scrap_d_qty">Quantity</th><th>Material (A00 code)</th></tr><tr><td><input class="haute-ligne col-md-6" required="true" size="16" type="number" ng-model="scrap.height"></td><td><input class="haute-ligne col-md-6" required="true" size="16" type="number" ng-model="scrap.width"></td><td><input class="haute-ligne col-md-10" required="true" size="16" type="text" ng-model="scrap.location"></td><td ng-show="sync.current.item.scrap_d_qty"><input class="haute-ligne col-md-10" size="16" type="number" ng-model="scrap.qty"></td><td><input class="haute-ligne col-md-10" size="16" type="text" ng-model="scrap.material"></td></tr></table><div class="btn-group btn-group-justified"><div class="btn-group"><button type="submit" class="btn btn-success haute-ligne">Add</button></div></div></fieldset></form><br><form name="scrap_use" ng-submit="" ng-show="scrap.search"><fieldset><table class="table table-condensed table-bordered" style="word-break: break-all;"><tr><th>Height</th><th>Width</th><th>Location</th><th ng-show="sync.current.item.scrap_d_qty">Quantity</th><th>Material</th><th>Use</th></tr><tr class="success" ng-repeat="item in scrap.avaiable"><td>{{ item.height }}</td><td>{{ item.width }}</td><td>{{ item.location }}</td><td ng-show="sync.current.item.scrap_d_qty">{{ item.qty }}</td><td>{{ item.material }}</td><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-click="useScrap(item, sync.current.item)"><span class="glyphicon glyphicon-ok"></span></button></div></td></tr></table></fieldset></form></div></div><form name="grid" ng-submit="formSubmitted=1"><fieldset ng-disabled="sync.current.item.workcenter_id != workcenter || raw_materials.$invalid"><div><button ng-show="sync.current.item.btnStartEnable" type="button" class="btn btn-default haute-ligne" ng-click="resign_reasons = !resign_reasons"><span class="glyphicon glyphicon-pause"></span>Resign</button><table class="table table-condensed" ng-show="resign_reasons"><tr><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-click="resign(sync.current.item, \'shortage\')">Components shortage / Brak komponentów</button></div></td></tr><tr><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-click="resign(sync.current.item, \'quality_issue\')">Quality issue / Wada jakościowa</button></div></td></tr><tr><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-click="resign(sync.current.item, \'not_ready\')">Not ready / Nie gotowe</button></div></td></tr><tr><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-click="resign(sync.current.item, \'leader_decision\')">Leader decision / Decyzja Lidera</button></div></td></tr><tr><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-click="resign(sync.current.item, \'no_time\')">No time / Brak czasu</button></div></td></tr></table></div><table class="table table-condensed" style="word-break: break-all;"><tr><th ng-repeat="field in fields">{{ field.name }}</th><th colspan="2">Operations</th><th>Rack</th><th></th></tr><tbody ng-repeat="line in sync.current.item._v.lines track by $index" ng-form="f{{$index}}"><tr ng-hide="isLineValid(grid, \'f\'+$index) && line.lock" ng-class="{false: \'locked\'}[line.lock]"><td ng-repeat="s in line.scans track by $index"><input class="haute-ligne" required="true" size="16" ng-model="line.scans[$index]" ng-focus="focusOnLineScan(line, $index)" ng-blur="lockOnValidLine(line, grid, \'f\'+$parent.$index)" ensure-value="{{ sync.current.item.lot_number }}"></td><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-show="sync.current.item.machine.type" ng-click="machine(sync.current.item)"><span class="glyphicon glyphicon-flag"></span></button></div></td><td><div class="btn-group"><button type="button" class="btn btn-warning haute-ligne" ng-click="print(sync.current.item)" ng-disabled="!sync.current.item._v.labels" ng-show="printAfterScan(sync.current.item, grid, \'f\'+$index)"><span class="glyphicon glyphicon-print">{{ sync.current.item._v.labels.length }}</span></button></div></td><td><input class="haute-ligne col-xs-5" required="true" ng-model="line.rack" ng-focus="focusOnLineRack(line)" ng-blur="lockOnValidLine(line, grid, \'f\'+$index)"></td><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-show="sync.current.item.quality_form_url" ng-click="openInNewTab(sync.current.item)"><span class="glyphicon glyphicon-comment"></span></button></div></td><td><button class="btn pull-right haute-ligne" ng-click="line.lock=true" ng-show="isLineValid(grid, \'f\'+$index)">Confirm</button></td></tr><tr ng-show="isLineValid(grid, \'f\'+$index) && line.lock"><td ng-repeat="s in line.scans track by $index">{{ s }}</td><td><div class="btn-group"><button type="button" class="btn btn-default haute-ligne" ng-show="sync.current.item.machine.type"><span class="glyphicon glyphicon-flag"></span></button></div></td><td><div class="btn-group"><button type="button" class="btn btn-warning haute-ligne" ng-click="print(sync.current.item)" ng-disabled="!sync.current.item._v.labels"><span class="glyphicon glyphicon-print">{{ sync.current.item._v.labels.length }}</span></button></div></td><td>{{line.rack}}</td><td><button class="btn pull-right haute-ligne" ng-click="line.lock=false">Edit</button></td></tr></tbody></table><div ng-hide="sync.current.item.state == \'done\'"><div class="btn-group btn-group-justified"><div class="btn-group"><button class="btn btn-success haute-ligne" ng-disabled="grid.$invalid || sync.current.item.pending || sync.current.item._v.lock || checkLocks()" ng-click="do(sync.current.item)" data-toggle="modal" data-target="#casier-modal">OK</button></div></div></div></fieldset></form></ion-scroll></div></div></div></div>'),e.put("app/assembly/orderList.html",'<div class="input-group"><div class="input-group-addon"><label for="searchInput"><span class="glyphicon glyphicon-search"></span></label></div><input ng-model="sync.current.filter.lot_number" ng-model-options="{ debounce: 100 }" class="form-control haute-ligne" id="searchInput" placeholder="search" ng-focus="eraseSearch()"></div><ion-scroll class="prodoo-ion-scroll" delegate-handle="leftScroll" direction="y"><div ng-show="!sync.current.filter.lot_number"><ul class="list-group tab"><li ng-repeat="item in filteredList.notDone" class="list-group-item list-link" ng-click="clickTask(item)" ng-class="{true: \'active\'}[sync.current.item==item]" id="item{{ item.id }}"><div class="alert" role="alert" ng-class="{\'1\': \'alert-danger\' , \'2\': \'alert-warning\' ,\'3\': \'alert-success\' }[item.alert_level]">{{ item.lot_number }} - {{ item.name}}</div><span class="badge badge-default pull-right" style="font-size:100%;">{{ item.qty }}</span> <span class="label label-danger pull-right" style="font-size:100%;" ng-show="item.pending">Pending</span> <span class="label label-success pull-right" style="font-size:100%;" ng-show="item.workcenter_id != workcenter">Bookable</span> <span class="label pull-right" style="font-size:100%;" ng-show="item.brand" ng-style="{\'background-color\': item.brand.color }">{{ item.brand.label}}</span><br><span ng-repeat="field in item.components">{{ field.name}} {{ field.rack}}</span><div ng-bind-html="item.short_description"></div></li><li ng-hide="filteredList.notDone">No order</li></ul></div><ul class="list-group tab" ng-show="sync.current.filter.lot_number"><li ng-repeat="item in filteredList.search" class="list-group-item list-link" ng-click="clickTask(item)" ng-class="{true: \'active\'}[sync.current.item==item]">{{ item.lot_number }} - {{ item.name}} <span class="badge badge-default pull-right" style="font-size:100%;">{{ item.qty }}</span> <span class="label label-danger pull-right" style="font-size:100%;" ng-show="item.pending">Pending</span> <span class="label label-success pull-right" style="font-size:100%;" ng-show="item.workcenter_id != workcenter">Bookable</span><br><div ng-bind-html="item.short_description"></div></li><li ng-hide="filteredList.search">No order</li></ul></ion-scroll>'),e.put("app/login/login.html",'<style>\n    .haute-ligne {\n        height: 3.5em;\n    }\n</style><div class="container"><div class="row"><div class="col-md-12" style="padding:2em;"><h1>Login</h1><form ng-submit="login(loginPassword)" class="form" name="form"><div class="form-group"><label for="loginPassword">Login Password</label> <input type="password" id="loginPassword" ng-model="loginPassword" class="haute-ligne" required=""></div><div class="form-group"><input type="submit" value="Submit" class="btn btn-primary haute-ligne" ng-disabled="form.$invalid"></div><div class="form-group"><input type="reset" value="Reset" class="btn haute-ligne"></div><div ng-show="error">{{ error }}</div></form></div></div></div>'),e.put("app/main/home.html",'<div class="container-fluid"><h1>Application List</h1><form class="form-inline"><div class="form-group"><label for="barcode">Workcenter</label> <input ng-model="barcode" type="number" id="barcode" class="haute-ligne"></div><div class="form-group"><input type="reset" value="Reset" class="btn btn-warning haute-ligne" ng-click="barcode = \'\'"></div><div class="form-group col-xs-offset-1"><div ng-repeat="workcenter in workcenters | filter:{id:barcode}:true" ng-show="barcode"><a ng-href="{{ $state.href(\'main.assembly\', { workcenter: workcenter.id}) }}" class="haute-ligne">{{ workcenter.name }}</a></div></div></form><hr><style>\n.workcenter-group {\n    min-height: 250px !important;\n}\n.workcenter-list {\n    line-height:270%;\n}\n</style><div ng-repeat="g in groups" class="col-md-4 workcenter-group list-group-item"><h2>{{ g[0].group }}</h2><ul class="list-unstyled"><li ng-repeat="w in g" class="workcenter-list"><a ng-href="{{ $state.href(\'main.assembly\', {workcenter: w.id}) }}">{{w.name}}</a></li></ul></div></div>'),e.put("app/main/main.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div ui-view=""></div>'),e.put("app/tdcp/tdcp.html",'<div class="container-fluid"><h2>Technical Description Check Point (TDCP)</h2><div class="input-group"><div class="input-group-addon"><button ng-click="goBack()" class="btn btn-default" type="button">Return</button> <button ng-click="clear()" class="btn btn-default" type="button">Clear</button></div><input ng-model="tdcp.lot_number" ng-model-options="{ debounce: 100 }" class="form-control haute-ligne" id="tdcpSearchInput" placeholder="search" ng-focus="eraseSearch()" autocomplete="off"></div><ion-scroll class="prodoo-ion-scroll" delegate-handle="leftScroll" direction="y" style="padding-right: 15px;"><ul class="list-group tab" ng-show="tdcp.lot_number" style="padding-right: 15px;"><li ng-repeat="item in tdcp.search" class="list-group-item list-link"><h3>{{ item.name}}</h3><h4 ng-hide="workcenter">Technical description</h4><div ng-hide="workcenter" ng-bind-html="item.table_tech_description"></div><h4 ng-show="workcenter">Short description</h4><div ng-show="workcenter" ng-bind-html="item.short_description"></div><br><h4 ng-show="workcenter">Step technical description</h4><div ng-show="workcenter" ng-bind-html="item.description"></div></li></ul></ion-scroll></div>'),e.put("components/navbar/navbar.html",'<nav class="navbar navbar-static-top navbar-inverse" ng-controller="NavbarCtrl"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" ui-sref="main.home"><span class="glyphicon glyphicon-home"></span>Home</a></div><ul class="nav navbar-nav"><li><a href="javascript:()">{{ title }}</a></li><li><a href="javascript:location.reload()"><span class="glyphicon glyphicon-repeat"></span>Reload</a></li></ul><ul class="nav navbar-nav navbar-right"><li><a ui-sref="main.tdcp({ workcenter: workcenter_id })">Technical Description Check Point (TDCP)</a></li><li><a ui-sref="main.configuration">Configuration</a></li><li><a ui-sref="login">Logout</a></li></ul></div></nav>')
}]);